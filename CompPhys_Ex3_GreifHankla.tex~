\documentclass[12pt,a4paper,twoside]{article}

% Include packages that contain additional features, for example including special mathematical characters and images in your document
\usepackage{amssymb,amsmath,graphicx}
\usepackage[hidelinks]{hyperref}
\usepackage{verbatim}
%\usepackage{pdfpages}

\title{Exercises III}
\author{Lia Hankla}
\date{Due 2018/05/11}

\begin{document}
\maketitle

\section*{Exercise 2}
Just as a check, Figure~\ref{fig:orbs} shows the results of integrating the 2-body problem for a sample eccentricity. Next, Figure~\ref{fig:2a} shows the desired double-logarithmic plot of relative error in energy. The plot shows the expected roughly linear increase in error with step size (slope can be seen to be about 1). \\
\\
To use the leapfrog algorithm (implemented below), we note that the acceleration depends only on the distance vector at that time. Figure~\ref{fig:lforb} shows the equivalent of Figure~\ref{fig:orbs} for the leapfrog integrator. Note that the error is much lower, as would be expected for a second-order method. Each step is third order in $h$ and we need $1/h$ to cover an orbit, so the global error should be $O(h^2)$. Figure~\ref{fig:lferr} shows a trend that's not quite linear, but close. If it were linear, its slope would be approximately 2 (seven orders of magnitude in error over three orders of magnitude in step size), so approximately $O(h^2)$. \\
\\
Also, part c seems to have been the same as part b. The program written for part a and b in Python follows.
\begin{figure}[h!]
\centering
\includegraphics[width=.9\textwidth]{C:/Users/Amelia/PycharmProjects/icp_exercises02/exercises021c_v1.pdf}
\caption{Euler Method proof-of-concept. Green stars indicate starting location, red stars are ending location. Results are similar for other eccentricities.} \label{fig:orbs}
\end{figure}
\begin{figure}[h!]
\centering
\includegraphics[width=.9\textwidth]{C:/Users/Amelia/PycharmProjects/icp_exercises02/exercises022a_relError.pdf}
\caption{Double-log plot of relative error in energy, seen to be roughly linear in step size. } \label{fig:2a}
\end{figure}
\begin{figure}[h!]
\centering
\includegraphics[width=.9\textwidth]{C:/Users/Amelia/PycharmProjects/icp_exercises02/exercises022c_leapfrogorb.pdf}
\caption{Leapfrog method proof-of-concept. Green/red stars indicate starting/ending location, respectively. Results are similar for other eccentricities.} \label{fig:lforb}
\end{figure}
\begin{figure}[h!]
\centering
\includegraphics[width=.9\textwidth]{C:/Users/Amelia/PycharmProjects/icp_exercises02/exercises022c_leapfrogorb.pdf}
\caption{Double-log plot of relative error in energy, seen to be roughly linear with slope 2 in step size. } \label{fig:lferr}
\end{figure}
\verbatiminput{C:/Users/Amelia/PycharmProjects/icp_exercises02/exercises02.py}
%
\end{document}

